# arm64_reverse_shellcode

C program to map arm64 reverse shell code into memory and execute code

## This will only work on target arm64 device. 

Source code for explotation of vulnerabilities in programs.
The arm64 code was tested on a Raspberry Pi running Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-1062-raspi2 aarch64).

## License

Please see the [LICENSE](LICENSE) file for the exact details.

## stack-overflow-gets
## stack-overflow-strcpy

## About

These C programs will demonstrate the exploitation of vulnerabilities in programs.If the user enters more characters than the buffer can handle the buffer overflows on the stack and the program is aborted.  Theese examples demonstrate a classic stack overflow.

This program can be ran as a shell or root user.

## Building and testing this Release

The stack-overflow code is build as shown below.
       
    $ cmake -DCMAKE_TOOLCHAIN_FILE=~/toolchain-aarch64-linux-gnu.cmake .. && make
    $ scp stack-overflow ubuntu@169.254.251.49:/home/ubuntu/download/stack-overflow
       
Program stack-overflow execution is shown below.
       
    $ ./stack-overflow-gets 
    0xfffffffff3a8
    What's your name?
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    Hello, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA!
    *** stack smashing detected ***: <unknown> terminated
    Aborted

Stack smashing was detected, now it will be removed and executed again.  Also, the execute stack is enabled.
       
In the CmakeList.txt uncomment the following

    # set C flags
    set (CMAKE_C_FLAGS "-fno-stack-protector")
    # set linker flags
    set (CMAKE_EXE_LINKER_FLAGS "-z execstack")
    
The stack-overflow code is build again as shown below.
       
    $ cmake -DCMAKE_TOOLCHAIN_FILE=~/toolchain-aarch64-linux-gnu.cmake .. &&   make
    $ scp stack-overflow-gets ubuntu@169.254.251.49:/home/ubuntu/stack-overflow

Next, execute the program disabling ALSR, so the same address will appear on subsequent running of the program.  Program stack-overflow execution is shown below.  Note the stack smashing is disabled.
       
    $ echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
    $./stack-overflow-gets 
    0xfffffffff3b0
    What's your name?
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    Hello, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA!
    Bus error
    